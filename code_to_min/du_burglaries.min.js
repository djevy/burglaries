if(!du_burglaries_bls_widget)var du_burglaries_bls_widget=function(){function e(e){v=L.map("du-canvas").setView([54.5,-3],5),y||(y=L.tileLayer(V.tl,{attribution:V.at,maxZoom:V.z})),v.addLayer(y),t(e),r()}function t(e){g&&(v.removeLayer(g),g=!1),g=L.geoJson(e,{style:a,onEachFeature:n}).addTo(v)}function a(){var e=.4;return{weight:2,color:"#000",opacity:e,fillColor:"#de6e18",fillOpacity:e}}function n(e,t){t.on("click",function(t){e.properties.LAD})}function r(){d();var e={user:"https://static.trinitymirrordataunit.com/img/burglaries/du_bls_icon.png",iSize:[30,30],iAnchor:[15,-15]},t=L.Icon.extend({options:{iconSize:e.iSize,iconAnchor:e.iAnchor}});H=new t({iconUrl:e.user})}function s(e,t,a,i){var n=L.popup().setContent(`<b>${a.name}</b>\n                            <p>Reported burglaries in 2021-22: <span class="du-bold-data">${a["2021-22"]}</span></p> \n                            <p>Reported burglaries in 2020-21: <span class="du-bold-data">${a["2020-21"]}</span></p> \n                            <p>Rank: <span class="du-bold-data">${J(a.rank)}</span></p> \n                            `),r=L.marker([e,t],{icon:H}).addTo(v);r.bindPopup(n,{permanent:!0,className:"du-popup",area:a.name,rank:a.rank,data:i,"2020-21":a["2020-21"],"2021-22":a["2021-22"]}).on("click",u),G.push(r)}function d(){G.forEach(e=>{v.removeLayer(e)}),G=[]}function o(e,t){v.fitBounds([e,t])}function u(e){v.setView(e.target.getLatLng(),11),U(e.target._popup.options.area,e.target._popup.options.data),M(e.target._popup.options.area,e.target._popup.options.data),m("#du-2020-21",h).text(e.target._popup.options["2020-21"]),m("#du-2021-22",h).text(e.target._popup.options["2021-22"])}function c(e){var t=[];e.forEach(e=>{t.push([e[1],e[0]])});var a=L.polygon(t).setStyle({color:"#363b59"}).addTo(v);W.push(a)}function l(){W.forEach(e=>{v.removeLayer(e)}),W=[]}function p(){let e=window.location.href;e=e.split("?")[0],e=e.split("#")[0];let t=e.replace("webviews","www");return e!=t&&(e=t.split("/embedded")[0]),e}document.getElementById("du-wait-bls").className="du-wait";var m,h,f=this,b=!1;this.originalJq=!1;var v,g,y,w=p(),_={postcode:"Please enter a postcode",error:"Postcode not found, please try again later",shown:"Please enter a new postcode",signup:"Invalid email or postcode, please try again",data:"There is no data available for this postcode"},k=[],j=!1,x=!1,C=!1,T='<div id="du-main-header" class="du-header"><div class="du-container"><img class="du-header-img" alt="burglaries" src="https://static.trinitymirrordataunit.com/img/burglaries/du_bls_header.png" /><div class="du-text">How many burglary cases were reported in your area? </div><div class="du-text">Enter your details below to find out</div><div id="du-search-box"><input type="text" name="du-search" id="du-search" maxlength="15" placeholder="Type your postcode" /><button type="button" id="du-search-go">Search</button></div></div></div><div id="du-widget"><div class="du-container"><!-- <div id="du-comparison-bar"></div> --><div id="du-mapContainer"><div id="du-canvas"></div></div><div id="du-slider-container"></div><div id="du-table-holder"><div id="du-result-table" class="du-table"><span class="du-table-head"><span class="du-table-row"><span class="du-table-cell du-row-header"> Period </span><span class="du-table-cell">Number of burglaries</span></span></span><span class="du-table-body" id="du-table-body"></span></div><div class="du-data-note du-table-footnote" style="display: none;"></div></div></div><div class="du-footer"><div class="du-text" id="du-footnote">*Figures exclude Greater Manchester, due to incomplete data.</div><div class="du-container"><ul id="du-social-holder"><li class="du-social-box"><a class="du-social-btn du-btn" target="_blank" href="" title=""><span></span></a></li></ul></div></div></div><div class="du-nlf-holder"></div>',I=!1,q="burglaries",F=!1,E=function(){if(h=m("#du-proj-burglaries.du-body"),m(window).resize(function(){f.resizeTO&&clearTimeout(f.resizeTO),f.resizeTO=setTimeout(function(){m(this).trigger("du-resizeEnd-bls")},150)}),m(window).bind("du-resizeEnd-bls",function(){f.du_checkParentSize()}),m("#du-widget-body",h).html(T),I=new du_support_fc(m),"function"==typeof du_newsletter){var e={m:h,jq:m,id:q,nl:"iya"};F=new du_newsletter(e)}Q(),ie(P,S),f.du_checkParentSize()},N=!1,P=function(t){!t&&t.length<=0?S():(m("#du-search",h).keypress(function(e){13==e.which&&(m("#du-search-go",h).click(),m(this).blur())}),m("#du-search-go",h).click(function(){var e=m("#du-search",h).val();F&&(F.showForm(),F.addPostcode(e)),A(m("#du-search",h).val()),clicked=!1,!1}),m(".du-banner",h).css("visibility","visible"),m("#du-widget .du-container",h).css("display","block"),m("#du-results",h).css("display","block"),e(t),ue(0))},z=function(e,t){void 0!==C.areas?j=C.areas:R(_.data),Object.keys(j).forEach(e=>{e=j[e],s(e.Lat,e.Long,{name:e["HoC Name"],"2020-21":e["2020-21"],"2021-22":e["2021-22"],rank:e.Rank,rate:e["Rate per 1000"]},e)})},O=function(e,t){({code:t,res:e}),m("#du-widget .du-container",h).fadeIn(),I.du_scrollPage(m("#du-widget",h).offset().top,1e3),F&&F.showForm(),ue(0)},R=function(e){alert(e),ue(0)},S=function(e){_.error;m("#du-header .du-text, #du-search-box,#du-widget",h).remove(),m("#du-row-error",h).show(),ue(0)},A=function(e){if(e=I.checkPostCode(I.du_myTrim(e)),x=e,e){if(m("#du-search",h).val(e),ue(1),void 0!==k[e])return void B(k[e],e);"function"==typeof btoa&&btoa(e);var t={type:"burglaries",vers:"2022",info:e};ae(t,B,S)}else R(_.postcode)},B=function(e,t){return void 0!==e.error?(R(e.error),!1):void 0===e?(R(_.error),!1):void 0!==e.res&&null!=e.res&&e.res&&void 0!==e.code&&null!=e.code&&e.code?(F&&F.addPostcode(x),k[x]=e,O(e.res,e.code),C=e.res,d(),l(),z(),currentLAD=e.code.la,void D()):(R(_.error),!1)},D=function(){var e=g._layers;Object.keys(e).forEach(t=>{t=e[t],t.feature.properties.LAD==currentLAD&&(c(t.feature.geometry.coordinates[0]),o(t._bounds._northEast,t._bounds._southWest))})},J=function(e){var t=e%10,a=e%100;return 1==t&&11!=a?I.addCommas(e)+"st":2==t&&12!=a?I.addCommas(e)+"nd":3==t&&13!=a?I.addCommas(e)+"rd":I.addCommas(e)+"th"},M=function(e,t){var a=function(e,t){for(i=0;i<e;i++)m(`#du-crimes-${t}`).append('<img class="du-icon du-icon-crime" src="https://static.trinitymirrordataunit.com/img/burglaries/du_bls_key_icon.png" alt="Key">')};m("#du-table-holder").show(),m("#du-table-body").empty(),m("#du-table-body").append(`                            \n                    <span class="du-table-row"><span class="du-table-cell du-row-header">Jun 2021 May 2022</span><span class="du-table-cell du-data-crimes" id="du-crimes-2021-22"></span><span class="du-table-cell du-data-qty">${t["2021-22"]}</span></span>\n                    <span class="du-table-row"><span class="du-table-cell du-row-header">Jun 2020 May 2021</span><span class="du-table-cell du-data-crimes" id="du-crimes-2020-21"></span><span class="du-table-cell du-data-qty">${t["2020-21"]}</span></span>\n            `),a(t["2021-22"],"2021-22"),a(t["2020-21"],"2020-21")},U=function(e,t){var a=function(e){return e<0?"decrease":"increase"};m("#du-slider-container").empty(),m("#du-slider-container").append(`                \n                <div class="du-section du-section-slider">\n                    <div class="du-text du-bottom-line""><span class="du-slider-title">${e}</span></div>\n                    <div class="du-text">This area has seen a <span class="du-bold-data">${Math.abs(100*t.Change).toFixed(1)}%</span> <span>${a(t.Change)}</span> in reported burglaries in 2021-22 compared to 2020-21. It is ranked <span class="du-bold-data">${J(t.Rank)}</span> out of 6,854 in terms of reported burglaries. </div>\n                    <div class="du-slider">\n                        <img id="du-slider-background" alt="burglaries" src="https://static.trinitymirrordataunit.com/img/burglaries/du_bls_slider.png" />\n                        <div id="du-slider-text"><span>Least</span><span>Most</span></div>\n\n                        <div id="du-slider-handle" class="du-slider-handle">\n\n                            <div id="du-slider-banner"><img class="du-slider-logo" alt="burglaries" src="https://static.trinitymirrordataunit.com/img/burglaries/du_bls_icon.png" /></div>\n                            <div id="du-slider-line"></div>\n                            <div id="du-slider-dot"></div>\n                        </div>\n                    </div>\n                </div>`);var i=1,n=6854,r=0-m("#du-slider-banner",h).innerWidth()/2,s=m("#du-slider-background",h).innerWidth()-m("#du-slider-banner",h).innerWidth()/2,d=I.du_calculatePosPercentage(t.Rank,n,i,r,s);m("#du-slider-handle",h).css("left",N.min),setTimeout(function(){m("#du-slider-handle",h).animate({left:d+"px"},{duration:2e3,easing:"swing"})},500)},H=!1,G=[],W=[],V={tl:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",at:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',z:19};let K={message:"I just used the Burglaries interactive on ",hash:"reachDataUnit,Burglaries",jqTemp:"",FBappID:!1,via:!1};var Q=function(){let e=["Facebook","Twitter","WhatsApp"],t=!1;K.FBappID=ee(),K.via=Y(),K.jqTemp=m(".du-social-box",h).clone(),m(".du-social-box",h).remove();for(const a in e){if(!e.hasOwnProperty(a))continue;const i=e[a];if("Facebook"==i&&!K.FBappID)continue;let n=Z(i);n&&(t=!0,m("#du-social-holder",h).append(n))}t?m("#du-social-holder",h).addClass("du-ok"):m("#du-social-holder",h).remove()},Z=function(e){let t=K.jqTemp.clone(),a=X(e);return m("a",t).attr({id:a.id,title:a.title,href:a.href}).on("click",function(){te(m(this).attr("id"))}).find("span").text(a.title),t},X=function(e){let t="Share on "+e;switch(e){case"Twitter":finalHref="https://twitter.com/intent/tweet?text="+encodeURIComponent(K.message)+"&url="+encodeURIComponent(w),void 0!==K.hash&&K.hash&&(finalHref+="&hashtags="+encodeURIComponent(K.hash)),void 0!==K.via&&K.via&&(finalHref+="&via="+encodeURIComponent(K.via));break;case"Facebook":finalHref="https://www.facebook.com/dialog/feed?&app_id="+K.FBappID+"&link="+encodeURIComponent(w)+"&redirect_uri="+encodeURIComponent(w);break;case"WhatsApp":finalHref="https://api.whatsapp.com/send?&text="+encodeURIComponent(K.message+w);break;default:alert("SOCIAL button missing configuration in script file")}return{title:t,href:finalHref,id:"du-btn-social-"+I.classFriendly(e)}},Y=function(){var e=!1;switch(!0){case!!m("meta[name='twitter:site']").attr("value"):e=m("meta[name='twitter:site']").attr("value"),e&&(e=e.replace("@",""))}return e},ee=function(){var e=!1;switch(!0){case!!m("meta[property='fb:app_id']").attr("content"):e=m("meta[property='fb:app_id']").attr("content");break;case!("undefined"==typeof TMCONFIG||void 0===TMCONFIG.facebook||void 0===TMCONFIG.facebook.appId):e=TMCONFIG.facebook.appId}return e};this.du_checkParentSize=function(){var e=m(h),t=m(h).parent();t.width()>618?e.removeClass("du-mobile").addClass("du-tablet"):e.removeClass("du-tablet").addClass("du-mobile")};var te=function(e){alert("missing analytics code \n"+e)},ae=function(e,t,a){m.ajax({type:"POST",url:"https://www.trinitymirrordataunit.com/burglaries/return_bls.json.php",contentType:"application/x-www-form-urlencoded",data:e,dataType:"json",success:function(e,a){t(e,a)},error:function(e,t){a(e,t)}})},ie=function(e,t){m.ajax({type:"GET",timeout:8e3,url:"https://www.trinitymirrordataunit.com/burglaries/du_burglaries_map.json",jsonpCallback:"runData_burglaries_map",dataType:"jsonp",success:function(t,a){e(t,a)},error:function(e,a){t(e,a)}})},ne=function(e){var t=document.getElementsByTagName("head")[0],a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.href=e,a.media="all",t.appendChild(a)},re={jquery:!1,temp:!1,loadNewJq:!1},se=function(){if(b)return!0;b=!0;var e={jq:"https://static.trinitymirrordataunit.com/js/jquery-3.6.0.min.js",xtra:["https://static.trinitymirrordataunit.com/js/jquery-ui.min.js","https://static.trinitymirrordataunit.com/js/jquery.ui.touch-punch.min.js","https://static.trinitymirrordataunit.com/js/du_support_fc_script.min.js","https://static.trinitymirrordataunit.com/js/du_newsletter.min.js","https://static.trinitymirrordataunit.com/js/leaflet.js"],css:["https://static.trinitymirrordataunit.com/img/burglaries/du_burglaries.min.css","https://static.trinitymirrordataunit.com/js/leaflet.css"]};for(let t=0;t<e.css.length;t++)ne(e.css[t]);"undefined"==typeof $?re.loadNewJq=!0:void 0!==$.fn?"3.5.1"!==$.fn.jquery&&(re.temp=$.noConflict(!0),re.loadNewJq=!0):(re.loadNewJq=!0,re.temp=$),re.loadNewJq&&e.xtra.unshift(e.jq),e.xtra.length>0?oe(e.xtra,function(){de()}):de()},de=function(){m=re.loadNewJq?$.noConflict(!0):$,re.temp?$=re.temp:$=m,void 0!==$.fn&&(jQuery=$),E()},oe=function(e,t){var a=e.shift(),i=document.createElement("script");i.src=a,i.async="async",i.onreadystatechange=i.onload=function(){var a=i.readyState;t.done||a&&!/loaded|complete/.test(a)||(t.done=!0,e.length>0?oe(e,function(){t()}):t())},document.getElementsByTagName("head")[0].appendChild(i)},ue=function(e){e?m(".du-wait",h).show():m(".du-wait",h).hide()};se()};